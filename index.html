<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Read an earn Bot</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<script src="https://sad.adsgram.ai/js/sad.min.js"></script>
<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:"Roboto",sans-serif;}
body{background:#000;color:white;padding:20px;padding-top:120px;}
.header{position:fixed;top:0;width:100%;background:#000;display:flex;justify-content:space-between;align-items:center;padding:15px 20px;z-index:100;}
.header h1{font-size:24px;}
.button-container{display:flex;flex-wrap:wrap;gap:10px;margin-bottom:20px;}
.btn{flex:1;padding:10px;border:none;border-radius:8px;cursor:pointer;font-weight:700;}
.read-btn{background:#007bff;color:white;}
.task-btn{background:#ffc107;color:black;}
.watch-btn{background:#28a745;color:white;}
.withdraw-btn{background:#6f42c1;color:white;}
.referral-btn{background:#fd7e14;color:white;}
.article-container{background:#222;padding:12px;border-radius:12px;overflow-y:auto;max-height:60vh;}
#commentSection{margin-top:15px;}
#commentBox, #submitComment{display:block;margin-top:10px;padding:8px;border-radius:6px;border:1px solid #555;background:#111;color:white;width:100%;}
.popup{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:#111;padding:20px;border-radius:12px;z-index:200;max-width:400px;width:90%;}
.toast{position:fixed;bottom:20px;left:50%;transform:translateX(-50%);background:#28a745;color:white;padding:10px 20px;border-radius:8px;opacity:0;transition:opacity 0.5s ease-in-out;z-index:200;}
.toast.show{opacity:1;}
</style>
</head>
<body style="display:none;">

<div class="header">
<h1>EarnZone Bot</h1>
<div id="pointsDisplay">Balance: 0 pts</div>
</div>

<div class="button-container">
<button class="btn read-btn" onclick="openArticle()">Read & Earn</button>
<button class="btn task-btn" onclick="showTaskAd()">Task & Earn</button>
<button class="btn watch-btn" onclick="showWatchAd()">Watch Videos</button>
<button class="btn withdraw-btn" onclick="openWithdraw()">Withdraw</button>
<button class="btn referral-btn" onclick="copyReferral()">Referral</button>
</div>

<div class="article-container" id="articleContainer"></div>

<div id="commentSection" style="display:none;">
<textarea id="commentBox" placeholder="Write a comment..."></textarea>
<button id="submitComment" class="btn read-btn" onclick="submitComment()">Submit Comment</button>
</div>

<!-- Withdraw Popup -->
<div class="popup" id="withdrawPopup" style="display:none;">
<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;"><h2>Withdraw Balance</h2><span onclick="closeWithdraw()" style="cursor:pointer">X</span></div>
<p>Your balance: <span id="withdrawPoints">0</span> pts</p>
<select id="withdrawMethod" style="margin-bottom:10px;width:100%;padding:8px;border-radius:6px;background:#111;color:white;border:1px solid #555;">
<option value="payeer">Payeer</option>
<option value="skrill">Skrill</option>
<option value="wire">Wire Transfer</option>
<option value="usdt">USDT TRC20</option>
</select>
<input id="withdrawDetails" placeholder="Account / Wallet details" style="margin-bottom:10px;width:100%;padding:8px;border-radius:6px;background:#111;color:white;border:1px solid #555;">
<button class="btn withdraw-btn" onclick="submitWithdraw()">Send Withdraw Request</button>
</div>

<div class="toast" id="toast"></div>

<script>
const tg = window.Telegram.WebApp ?? { sendData: () => {}, expand: () => {} };
tg.expand();

let storedBalance = parseInt(localStorage.getItem('userBalance'));
let userBalance = isNaN(storedBalance) ? 0 : storedBalance;
updateBalance();

function updateBalance(){
  document.getElementById('pointsDisplay').innerText = `Balance: ${userBalance} pts`;
}
function saveBalance(){
  localStorage.setItem('userBalance', userBalance);
  updateBalance();
}
function showToast(msg){
  const t=document.getElementById('toast');
  t.innerText=msg;
  t.classList.add('show');
}

// --- Adsgram Reward on Page Load ---
const rewardAd = window.Adsgram.init({ blockId: "18943" });
rewardAd.show().then(res => {
  if(res.done){ userBalance += 100; saveBalance(); }
  document.body.style.display='block';
}).catch(err=>{
  console.log(err);
  document.body.style.display='block';
});

// --- Read & Earn ---
function openArticle(){
  const articleText = `
<h2>Top 5 Ways to Make Money Online in 2025</h2>
<p>2025 offers huge opportunities for digital income. Freelancing, AI content creation, affiliate marketing, online courses, and smart crypto investing are among the best ways to earn.</p>
<ol>
<li><b>Freelancing:</b> Offer skills on Fiverr, Upwork, etc.</li>
<li><b>AI Content:</b> Use ChatGPT to create content for businesses.</li>
<li><b>Affiliate Marketing:</b> Promote products and earn commissions.</li>
<li><b>Online Courses & Ebooks:</b> Teach skills and sell online.</li>
<li><b>Crypto & NFT:</b> Staking, NFTs, and P2E gaming for high returns.</li>
</ol>`;
  document.getElementById('articleContainer').innerHTML = articleText;
  document.getElementById('commentSection').style.display='block';
}

// --- Submit Comment with Date & Time ---
function submitComment(){
  const commentText = document.getElementById("commentBox").value.trim();

  if(!commentText){
    showToast("❌ Write a comment first!");
    return;
  }

  if(userBalance < 4,000){
    showToast("❌ You don't have 4,000 points to comment!");
    showClaimTask();
    return;
  }

  userBalance -= 4,000;
  saveBalance();

  showToast("✅ Comment submitted successfully!");

  document.getElementById("commentBox").remove();
  document.getElementById("submitComment").remove();

  const now = new Date();
  const dateStr = now.toLocaleDateString();
  const timeStr = now.toLocaleTimeString();

  const newComment = document.createElement("div");
  newComment.style.marginTop = "15px";
  newComment.style.padding = "10px";
  newComment.style.background = "#111";
  newComment.style.borderRadius = "8px";
  newComment.innerHTML = `<p>${commentText}</p><small style="color:#aaa;">Posted on ${dateStr} at ${timeStr}</small>`;

  document.getElementById("commentSection").appendChild(newComment);

  setTimeout(() => {
    document.getElementById("toast").classList.remove("show");
  }, 30000);
}

// --- Task & Earn ---
const taskBlocks = ["task-18944","task-18945","task-18946","task-18947","task-18948"];
let currentTaskIndex = 0;
function showTaskAd(){
  const blockId = taskBlocks[currentTaskIndex];
  const taskContainer = document.createElement('div');
  taskContainer.innerHTML = `<adsgram-task data-block-id="${blockId}" class="task"></adsgram-task>`;
  document.body.appendChild(taskContainer);
  const taskEl = taskContainer.querySelector('adsgram-task');
  taskEl.addEventListener('reward', () => {
    userBalance += 100;
    saveBalance();
    showToast("✅ Task completed! +100 pts");
    currentTaskIndex = (currentTaskIndex + 1) % taskBlocks.length;
    taskContainer.remove();
  }, {once:true});
}

// --- Claim Task When Comment Points Insufficient ---
function showClaimTask(){
  const blockId = taskBlocks[currentTaskIndex];
  const claimContainer = document.createElement('div');
  claimContainer.innerHTML = `<adsgram-task data-block-id="${blockId}" class="task"></adsgram-task>`;
  document.body.appendChild(claimContainer);
  const taskEl = claimContainer.querySelector('adsgram-task');
  taskEl.addEventListener('reward', () => {
    userBalance += 100;
    saveBalance();
    showToast("✅ Points claimed! You can now comment.");
    currentTaskIndex = (currentTaskIndex + 1) % taskBlocks.length;
    claimContainer.remove();
  }, {once:true});
}

// --- Watch Videos ---
function showWatchAd(){
  rewardAd.show().then(res => {
    if(res.done){
      userBalance += 100;
      saveBalance();
      showToast("✅ Video watched! +100 pts");
    }
  }).catch(console.log);
}

// --- Referral ---
function copyReferral(){
  const ref = `https://t.me/Airticlebot?start=${Math.floor(Math.random()*1000000)}`;
  navigator.clipboard.writeText(ref);
  showToast("Referral link copied!");
}

// --- Withdraw ---
const MIN_WITHDRAW = 50000;
function openWithdraw(){
  if(userBalance < MIN_WITHDRAW){
    showToast("❌ You don't have enough funds to withdraw. Minimum 50,000 pts required.");
    return;
  }
  document.getElementById('withdrawPopup').style.display='block';
  document.getElementById('withdrawPoints').innerText=userBalance;
}
function closeWithdraw(){ document.getElementById('withdrawPopup').style.display='none'; }
function submitWithdraw(){
  if(userBalance < MIN_WITHDRAW){
    showToast("❌ You don't have enough funds to withdraw. Minimum 50,000 pts required.");
    return;
  }
  const method = document.getElementById('withdrawMethod').value;
  const details = document.getElementById('withdrawDetails').value.trim();
  if(!details){showToast("❌ Enter account/wallet details."); return;}
  tg.sendData(JSON.stringify({action:"withdraw", amount:MIN_WITHDRAW, method, details}));
  showToast(`✅ Withdraw request of 50,000 pts sent via ${method}`);
  userBalance -= MIN_WITHDRAW;
  saveBalance();
  closeWithdraw();
}
</script>
</body>
</html>
